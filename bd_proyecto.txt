CREATE TABLE estados (
    est_id integer NOT NULL,
    est_nombre character varying
);

INSERT INTO estados (est_id, est_nombre) VALUES (1, 'Activo');
INSERT INTO estados (est_id, est_nombre) VALUES (2, 'Inactivo');
INSERT INTO estados (est_id, est_nombre) VALUES (3, 'Pendiente');
INSERT INTO estados (est_id, est_nombre) VALUES (4, 'En revision');
INSERT INTO estados (est_id, est_nombre) VALUES (5, 'En proceso');
INSERT INTO estados (est_id, est_nombre) VALUES (6, 'Rechazada');
INSERT INTO estados (est_id, est_nombre) VALUES (7, 'Completada');

CREATE TABLE tipo_estado(
    id_tipo_estado INTEGER NOT NULL,
    id_estado INTEGER,
    id_perteneciente INTEGER,
);

INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (1, 1, 1);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (2, 2, 1);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (3, 3, 2);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (4, 4, 2);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (5, 5, 2);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (6, 6, 2);
INSERT INTO tipo_estado (id_tipo_estado, id_estado, id_perteneciente) VALUES (7, 7, 2);

CREATE TABLE rol (
    rol_id integer NOT NULL,
    rol_nombre character varying(30)
);

INSERT INTO rol (rol_id, rol_nombre) VALUES (1, 'Admin');
INSERT INTO rol (rol_id, rol_nombre) VALUES (2, 'Ciudadano');
INSERT INTO rol (rol_id, rol_nombre) VALUES (3, 'Funcionario');

CREATE TABLE tipo_documento (
    doc_id integer NOT NULL,
    nombre_tipo character varying,
    doc_abrev character varying(4)
);

INSERT INTO tipo_documento (doc_id, nombre_tipo, doc_abrev) VALUES (1, 'Cedula de ciudadania', 'CC');
INSERT INTO tipo_documento (doc_id, nombre_tipo, doc_abrev) VALUES (2, 'Cedula de extranjeria', 'CE');


CREATE TABLE sexo(
    sex_id SERIAL,
    sex_desc character varying(50)
);

INSERT INTO sexo (sex_id, sex_desc) VALUES (1, 'Masculino'), (2, 'Femenino');

CREATE TABLE usuarios (
    usu_id integer NOT NULL,
    usu_documento character varying(50) NOT NULL,
    usu_nombre1 character varying(50) NOT NULL,
    usu_nombre2 character varying(50),
    usu_apellido1 character varying(50) NOT NULL,
    usu_apellido2 character varying(50),
    usu_correo character varying(50) NOT NULL,
    usu_clave character varying(255) NOT NULL,
    usu_tel character varying(50) NOT NULL,
    usu_direccion character varying(500) NOT NULL,
    rol_id integer,
    est_id integer,
    doc_id integer,
    sex_id integer
);

INSERT INTO usuarios 
VALUES (1, 'Jose', 'Daniel', 'Ruiz', 'Montaño', 'jose@gmail.com', '3c165908b463ee85a6a32ab2f7c25a9f8a31431cd2cca0a128ea1db41fca8657', '3013623149', 'Calle 120 C 22 42', 1, 1, 1, 1);


CREATE TABLE pqrs(
    id_pqrs INTEGER NOT NULL,
    desc_pqrs character varying(50) NOT NULL, 
    tipo_pqrs INTEGER,
    usu_id INTEGER 
);

CREATE TABLE tipo_pqrs(
    id_tipo_pqrs INTEGER, 
    desc_tipo_pqrs character varying(50) NOT NULL
);

INSERT INTO tipo_pqrs VALUES (1, 'Peticion'),(2, 'Queja'), (3, 'Reclamos'), (4, 'Sugerencias');


REGISTRO DE ACCIDENTES TABLAS 

CREATE TABLE registro_accidente
(
    reg_acc_id serial primary key NOT NULL,
    reg_acc_fecha_hora timestamp NOT NULL,
    tipo_accidente_id integer NOT NULL,
    reg_acc_lesionados boolean NOT NULL,
    reg_acc_observaciones character varying NOT NULL,
    usu_id integer NOT NULL
);

CREATE TABLE punto_accidente
(
  id serial NOT NULL,
  id_accidente integer NOT NULL,
  geom geometry(Point,4326)
);


CREATE TABLE imagenes_accidente
(
    img_id integer NOT NULL,
    reg_acc_id integer NOT NULL,
    img_ruta character varying,
    CONSTRAINT imagenes_accidente_pkey PRIMARY KEY (img_id),
    CONSTRAINT imagenes_accidente_reg_acc_id_fkey FOREIGN KEY (reg_acc_id)
        REFERENCES public.registro_accidente (reg_acc_id)
);

CREATE TABLE vehiculo
(
    vehiculo_id integer NOT NULL,
    vehiculo_descripcion character varying(30) NOT NULL,
    CONSTRAINT vehiculo_pkey PRIMARY KEY (vehiculo_id)
);

INSERT INTO vehiculo (vehiculo_id, vehiculo_descripcion) VALUES
(1, 'Automóvil'),
(2, 'Bus'),
(3, 'Buseta'),
(4, 'Camión'),
(5, 'Camioneta'),
(6, 'Microbús'),
(7, 'Tractocamión'),
(8, 'Volqueta'),
(9, 'Motocicleta'),
(10, 'Bicicleta'),
(11, 'Motocarro'),
(12, 'Cuatrimoto');

CREATE TABLE reg_acc_vehi
(
    reg_acc_vehi_id integer NOT NULL,
    reg_acc_id integer NOT NULL,
    vehiculo_id integer NOT NULL,
    CONSTRAINT reg_acc_vehi_pkey PRIMARY KEY (reg_acc_vehi_id),
    CONSTRAINT reg_acc_vehi_reg_acc_id_fkey FOREIGN KEY (reg_acc_id)
        REFERENCES public.registro_accidente (reg_acc_id),
    CONSTRAINT reg_acc_vehi_vehiculo_id_fkey FOREIGN KEY (vehiculo_id)
        REFERENCES public.vehiculo (vehiculo_id)
);

CREATE TABLE tipo_choque
(
    tipo_choque_id integer NOT NULL,
    tipo_choque_desc character varying,
    CONSTRAINT tipo_choque_pkey PRIMARY KEY (tipo_choque_id)
);

INSERT INTO tipo_choque (tipo_choque_id, tipo_choque_desc) VALUES
(1, 'Colisión entre vehiculos'),
(2, 'Colisión con objeto fijo'),
(3, 'Atropello'),
(4, 'Volcamiento');

CREATE TABLE choque_detalle
(
    choq_detal_id integer NOT NULL,
    descripcion character varying(80),
    id_perteneciente integer,
    CONSTRAINT choque_detalle_pkey PRIMARY KEY (choq_detal_id)
);

INSERT INTO choque_detalle (choq_detal_id, descripcion, id_perteneciente) VALUES
(1, 'Automóvil con Bus', 1),
(2, 'Automóvil con Buseta', 1),
(3, 'Automóvil con Camión', 1),
(4, 'Automóvil con Camioneta', 1),
(5, 'Automóvil con Microbús', 1),
(6, 'Automóvil con Tractocamión', 1),
(7, 'Automóvil con Volqueta', 1),
(8, 'Automóvil con Motocicleta', 1),
(9, 'Automóvil con Bicicleta', 1),
(10, 'Automóvil con Motocarro', 1),
(11, 'Automóvil con Cuatrimoto', 1),
(12, 'Bus con Buseta', 1),
(13, 'Bus con Camión', 1),
(14, 'Bus con Camioneta', 1),
(15, 'Bus con Microbús', 1),
(16, 'Bus con Tractocamión', 1),
(17, 'Bus con Volqueta', 1),
(18, 'Bus con Motocicleta', 1),
(19, 'Bus con Bicicleta', 1),
(20, 'Bus con Motocarro', 1),
(21, 'Bus con Cuatrimoto', 1),
(22, 'Buseta con Camión', 1),
(23, 'Buseta con Camioneta', 1),
(24, 'Buseta con Microbús', 1),
(25, 'Buseta con Tractocamión', 1),
(26, 'Buseta con Volqueta', 1),
(27, 'Buseta con Motocicleta', 1),
(28, 'Buseta con Bicicleta', 1),
(29, 'Buseta con Motocarro', 1),
(30, 'Buseta con Cuatrimoto', 1),
(31, 'Camión con Camioneta', 1),
(32, 'Camión con Microbús', 1),
(33, 'Camión con Tractocamión', 1),
(34, 'Camión con Volqueta', 1),
(35, 'Camión con Motocicleta', 1),
(36, 'Camión con Bicicleta', 1),
(37, 'Camión con Motocarro', 1),
(38, 'Camión con Cuatrimoto', 1),
(39, 'Camioneta con Microbús', 1),
(40, 'Camioneta con Tractocamión', 1),
(41, 'Camioneta con Volqueta', 1),
(42, 'Camioneta con Motocicleta', 1),
(43, 'Camioneta con Bicicleta', 1),
(44, 'Camioneta con Motocarro', 1),
(45, 'Camioneta con Cuatrimoto', 1),
(46, 'Microbús con Tractocamión', 1),
(47, 'Microbús con Volqueta', 1),
(48, 'Microbús con Motocicleta', 1),
(49, 'Microbús con Bicicleta', 1),
(50, 'Microbús con Motocarro', 1),
(51, 'Microbús con Cuatrimoto', 1),
(52, 'Tractocamión con Volqueta', 1),
(53, 'Tractocamión con Motocicleta', 1),
(54, 'Tractocamión con Bicicleta', 1),
(55, 'Tractocamión con Motocarro', 1),
(56, 'Tractocamión con Cuatrimoto', 1),
(57, 'Volqueta con Motocicleta', 1),
(58, 'Volqueta con Bicicleta', 1),
(59, 'Volqueta con Motocarro', 1),
(60, 'Volqueta con Cuatrimoto', 1),
(61, 'Motocicleta con Bicicleta', 1),
(62, 'Motocicleta con Motocarro', 1),
(63, 'Motocicleta con Cuatrimoto', 1),
(64, 'Bicicleta con Motocarro', 1),
(65, 'Bicicleta con Cuatrimoto', 1),
(66, 'Motocarro con Cuatrimoto', 1),
(67, 'Poste', 2),
(68, 'Señal de Tránsito', 2),
(69, 'Árbol', 2),
(70, 'Muro', 2),
(71, 'Peatón', 3),
(72, 'Animal', 3),
(73, 'Exceso de velocidad', 4),
(74, 'Maniobra brusca', 4),
(75, 'Pérdida de control', 4),
(76, 'Sobrecarga', 4),
(77, 'Mal estado de la vía', 4),
(78, 'Curva cerrada', 4),
(79, 'Evasión de obstáculo', 4),
(80, 'Terreno resbaladizo', 4);


INSERT INTO choque_detalle (choq_detal_id, descripcion, id_perteneciente) VALUES
(11, 'Alta velocidad', 4),
(12, 'Pavimento mojado', 4),
(13, 'Error mecanico', 4);

CREATE TABLE registro_detalle_accidente
(
    reg_det_acc_id integer NOT NULL,
    reg_acc_id integer NOT NULL,
    choque_detalle_id integer NOT NULL,
    CONSTRAINT registro_detalle_accidente_pkey PRIMARY KEY (reg_det_acc_id),
    CONSTRAINT registro_detalle_accidente_choque_detalle_id_fkey FOREIGN KEY (choque_detalle_id)
        REFERENCES public.choque_detalle (choq_detal_id),
    CONSTRAINT registro_detalle_accidente_reg_acc_id_fkey FOREIGN KEY (reg_acc_id)
        REFERENCES public.registro_accidente (reg_acc_id)
);

REGISTRO DAÑOS EN VIA 

CREATE TABLE solicitud_via_dan
(
    sol_via_dan_id integer NOT NULL,
    tipo_dano_via_id integer,
    descripcion_via character varying,
    fecha_hora timestamp without time zone NOT NULL,
    est_sol_id integer,
    usu_id integer,
    CONSTRAINT solicitud_via_dan_pkey PRIMARY KEY (sol_via_dan_id)
);


CREATE TABLE punto_via
(
  id serial NOT NULL,
  id_via integer NOT NULL,
  geom geometry(Point,4326)
)


CREATE TABLE imagenes_vias
(
    img_id integer NOT NULL,
    reg_via_id integer NOT NULL,
    img_ruta character varying NOT NULL,
    CONSTRAINT imagenes_vias_pkey PRIMARY KEY (img_id),
    CONSTRAINT imagenes_vias_reg_via_id_fkey FOREIGN KEY (reg_via_id)
        REFERENCES public.solicitud_via_dan (sol_via_dan_id) 
);




DAÑOS

CREATE TABLE danio
(
    danio_id integer NOT NULL,
    tipo_danio_id integer,
    solicitud_id integer,
    CONSTRAINT danio_pkey PRIMARY KEY (danio_id)
);

INSERT INTO danio (danio_id, tipo_danio_id, solicitud_id) VALUES
(1, 1, 1),
(2, 2, 1),
(3, 3, 1),
(4, 4, 2),
(5, 5, 2),
(6, 6, 2),
(7, 7, 3),
(8, 8, 3),
(9, 9, 3);

CREATE TABLE tipo_danio
(
    tipo_danio_id integer NOT NULL,
    tipo_danio_desc character varying(100),
    CONSTRAINT tipo_danio_pkey PRIMARY KEY (tipo_danio_id)
);

INSERT INTO tipo_danio (tipo_danio_id, tipo_danio_desc) VALUES
(1, 'Huecos en la vía'),
(2, 'Fisuras o grietas'),
(3, 'Hundimientos'),
(4, 'Señal caída'),
(5, 'Señal vandalizada'),
(6, 'Señal ilegible'),
(7, 'Desgaste en reductores'),
(8, 'Desnivel en reductores'),
(9, 'Ausencia de reductores');





